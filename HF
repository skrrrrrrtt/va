-- CLEAN PLS DONATE SCRIPT (FIXED TELEPORT + CLEANED)
-- Auto-Claim Booth + Teleport + Face Forward + Anti-AFK + Auto-Jump + Goal Text

repeat task.wait() until game:IsLoaded()

_G.goalAmount = 1000 -- ðŸŽ¯ Your donation goal

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualUser = game:GetService("VirtualUser")

local LocalPlayer = Players.LocalPlayer
local pg = LocalPlayer:WaitForChild("PlayerGui")

-----------------------------------------------------
-- ðŸ”¹ ANTI-AFK
-----------------------------------------------------
LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-----------------------------------------------------
-- ðŸ”¹ WAIT FOR MAP UI
-----------------------------------------------------
repeat task.wait() until pg:FindFirstChild("MapUIContainer")
local BoothUI = pg.MapUIContainer.MapUI:WaitForChild("BoothUI")

-----------------------------------------------------
-- ðŸ”¹ FIND UNCLAIMED BOOTHS
-----------------------------------------------------
local function findUnclaimed()
    local free = {}
    for _, ui in ipairs(BoothUI:GetChildren()) do
        if ui:FindFirstChild("Details") and ui.Details.Owner.Text == "unclaimed" then
            
            local boothNum = tonumber(ui.Name:match("%d+"))
            if boothNum then
                for _, booth in ipairs(workspace.BoothInteractions:GetChildren()) do
                    if booth:GetAttribute("BoothSlot") == boothNum then
                        table.insert(free, boothNum)
                    end
                end
            end

        end
    end
    return free
end

-----------------------------------------------------
-- ðŸ”¹ UPDATE BOOTH TEXT
-----------------------------------------------------
local function updateBoothText()
    local raised = LocalPlayer.leaderstats.Raised.Value
    local text = "GOAL " .. raised .. " / " .. _G.goalAmount

    local Rem = require(ReplicatedStorage.Remotes)
    Rem.Event("SetBoothText"):FireServer(text, "booth")
end

-----------------------------------------------------
-- ðŸ”¹ CLAIM BOOTH + SAFE TELEPORT
-----------------------------------------------------
local function claimBooth()
    local freeBooths = findUnclaimed()
    if #freeBooths == 0 then
        warn("âš  No unclaimed booths found.")
        return
    end

    local boothNum = freeBooths[1]
    local Rem = require(ReplicatedStorage.Remotes)

    -- Claim booth
    Rem.Event("ClaimBooth"):InvokeServer(boothNum)

    task.wait(1)

    -------------------------------------------------
    -- SAFE TELEPORT USING *ACTUAL BOOTH MODEL*
    -------------------------------------------------
    for _, booth in ipairs(workspace.BoothInteractions:GetChildren()) do
        if booth:GetAttribute("BoothSlot") == boothNum then
            
            -- Actual booth model (safe!)
            local boothModel = booth.Parent
            local primary = boothModel:FindFirstChild("PrimaryPart")

            if primary then
                local hrp = LocalPlayer.Character:WaitForChild("HumanoidRootPart")

                -- Teleport slightly above booth so you never fall under map
                hrp.CFrame = primary.CFrame + Vector3.new(0, 4, 0)
                task.wait(0.2)

                -- Face forward
                hrp.CFrame = CFrame.new(hrp.Position, hrp.Position + primary.CFrame.LookVector)
            else
                warn("âŒ Booth model missing PrimaryPart")
            end
        end
    end

    updateBoothText()
    print("âœ” Booth claimed:", boothNum)
end

-----------------------------------------------------
-- ðŸ”¹ AUTO CLAIM ON SPAWN
-----------------------------------------------------
claimBooth()

Players.LocalPlayer.CharacterAdded:Connect(function()
    task.wait(2)
    claimBooth()
end)

-----------------------------------------------------
-- ðŸ”¹ AUTO-JUMP ON DONATION
-----------------------------------------------------
local raisedStat = LocalPlayer.leaderstats.Raised
local last = raisedStat.Value

raisedStat.Changed:Connect(function(new)
    if new > last then
        local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
        if hum then
            for i = 1, 3 do
                hum:ChangeState(Enum.HumanoidStateType.Jumping)
                task.wait(0.35)
            end
        end
        updateBoothText()
    end
    last = new
end)

print("ðŸŽ‰ Loaded: Auto Booth + Safe Teleport + Anti-AFK + Auto Jump + Goal Text")
